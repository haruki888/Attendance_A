<% provide(:title, 'All Users') %>
<% provide(:btn_text, '更新') %>

  <h1>ユーザー一覧</h1>
  
    <%= form_with url: import_users_path, local: true do |f| %>
      <div class="input-group">
        <%= f.submit 'ファイルを選択', class: "btn btn-secondary" %>
        <span class= "input-group-btn" >
          <%= f.text_field :text, value: params[:csv], class: "form-control" %>
        </span>
      </div>
      <%= f.submit "CSVをインポート", class: "btn btn-primary csv-botton" %>
    <% end %>
    
  <div class="col-md-11 col-md-offset-1">
    <% @users.each do |user| %>
      <% unless user.admin? %>
          <%= user.name %><br>
          <span>| </span>
            <%= link_to "削除", user, method: :delete, 
            data: { confirm: "削除してよろしいですか？" },
            class: "btn btn-primary" %>
        
          <div class="panel-group">
            <div class="panel panel-default">
              <div class="panel-heading">
                <div class="panel-title">
                  <button data-toggle="collapse" data-target="#collapse<%= user.id %>" type="button" class = "btn btn-primary btn-lg">編集</button>
                </div>                                        
              </div>
              <div id="collapse<%= user.id %>" class="panel-collapse collapse">
              <div class="panel-body">
                <%= render 'user.index', locals: {user: @user = User.find_by(id: user.id) } %>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>  
